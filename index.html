<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kosmodrier Mobile Faneromundus</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Great+Vibes&family=Cormorant+Garamond:ital,wght@0,600;1,600&family=Rajdhani:wght@300;500;700&display=swap');
        
        :root {
            --bg-deep: #050a14;
            --gold-fanero: #c5a021;
            --blue-fanero: #4ea8de;
        }

        body {
            background-color: var(--bg-deep);
            color: #ffffff;
            font-family: 'Rajdhani', sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        .serif-title { font-family: 'Cormorant Garamond', serif; font-weight: 600; text-transform: uppercase; }
        .handwritten { font-family: 'Great Vibes', cursive; color: #7dd3fc; }
        .sketch-font { font-family: 'Cinzel', serif; font-weight: 700; letter-spacing: -2px; }
        
        .glass-panel {
            background: linear-gradient(145deg, rgba(15, 23, 42, 0.9), rgba(5, 10, 20, 1));
            border: 1px solid rgba(197, 160, 33, 0.2);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .fanero-glow {
            text-shadow: 0 0 15px rgba(197, 160, 33, 0.5);
        }

        .btn-active-real {
            background: rgba(197, 160, 33, 0.15);
            border: 1px solid var(--gold-fanero);
            color: var(--gold-fanero);
        }

        .btn-active-fareno {
            background: rgba(78, 168, 222, 0.15);
            border: 1px solid var(--blue-fanero);
            color: var(--blue-fanero);
        }
    </style>
</head>
<body class="p-4 flex flex-col min-h-screen">

    <!-- Logo & Header -->
    <div class="text-center mb-6">
        <h1 class="serif-title text-2xl tracking-[0.3em] mb-1">FANEROMUNDUS<span class="text-[0.6rem] align-top">TM</span></h1>
        <div class="text-[0.6rem] tracking-[0.5em] opacity-80 uppercase">Éveil Élémentaire</div>
    </div>

    <!-- Section Infos Temps (Synchronisation Solaire Hijri) -->
    <div class="flex justify-between items-end border-b border-white/20 pb-2 mb-6">
        <div class="handwritten text-3xl transform -rotate-6" id="season-label">Hiver</div>
        <div class="flex items-baseline gap-2">
            <span class="text-5xl font-bold" id="day-num">--</span>
            <div class="text-left">
                <div class="text-[0.7rem] uppercase leading-none opacity-60" id="day-name-small">--</div>
                <div class="text-sm font-bold serif-title leading-tight" id="day-name-real">--</div>
            </div>
        </div>
        <div class="text-right">
            <div class="flex items-baseline gap-1">
                <span class="text-4xl font-bold" id="cycle-num">--</span>
                <span class="serif-title text-xl tracking-widest" id="cycle-name">--</span>
            </div>
            <div class="text-[0.5rem] uppercase tracking-widest opacity-40 serif-title" id="persian-sync-info">Sync. Perse</div>
        </div>
    </div>

    <!-- Rayon Style Croquis -->
    <div class="absolute right-6 top-32">
        <div class="sketch-font text-5xl opacity-30 italic" style="color: #475569;" id="val-rayon-sketch">--</div>
    </div>

    <!-- Centre d'affichage -->
    <div id="display-center" class="w-full glass-panel aspect-[16/9] rounded-xl flex flex-col items-center justify-center relative my-8">
        <div class="absolute top-2 left-4 text-[0.5rem] tracking-[0.4em] opacity-40 serif-title">TRAME DE FLUX</div>
        <div id="sigle-main" class="serif-title text-8xl fanero-glow" style="color: var(--gold-fanero);">--</div>
        <div id="day-full" class="serif-title text-xs tracking-[0.4em] mt-4 opacity-90">--</div>
    </div>

    <!-- Compteurs Techniques -->
    <div class="grid grid-cols-3 gap-2 mb-8">
        <div class="bg-white/5 p-2 rounded text-center border-b border-white/10">
            <div class="text-[0.5rem] uppercase opacity-50 mb-1">Onde</div>
            <div id="val-onde" class="text-xl font-medium">--</div>
        </div>
        <div class="bg-white/5 p-2 rounded text-center border-b border-white/10">
            <div class="text-[0.5rem] uppercase opacity-50 mb-1">Impulsion</div>
            <div id="val-impulsion" class="text-xl font-medium">--</div>
        </div>
        <div class="bg-white/5 p-2 rounded text-center border-b border-white/10">
            <div class="text-[0.5rem] uppercase opacity-50 mb-1">Battement</div>
            <div id="val-battement" class="text-xl font-medium text-blue-400">--</div>
        </div>
    </div>

    <!-- Contrôles du Plan -->
    <div class="mt-auto grid grid-cols-2 gap-4 pb-4">
        <button onclick="setPlan('real')" id="btn-real" class="py-4 rounded-full serif-title text-[0.7rem] tracking-widest transition-all btn-active-real">Plan Matériel</button>
        <button onclick="setPlan('universe')" id="btn-universe" class="py-4 rounded-full serif-title text-[0.7rem] tracking-widest transition-all opacity-40">Plan Fareno</button>
    </div>

    <script>
        let currentPlan = 'real';
        
        const fullDaysReal = { 0: "DIMANCHE", 1: "LUNDI", 2: "MARDI", 3: "MERCREDI", 4: "JEUDI", 5: "VENDREDI", 6: "SAMEDI" };
        const shortDaysReal = { 0: "DIM", 1: "LUN", 2: "MAR", 3: "MER", 4: "JEU", 5: "VEN", 6: "SAM" };
        const monthsReal = ["Janv.", "Févr.", "Mars", "Avril", "Mai", "Juin", "Juil.", "Août", "Sept.", "Oct.", "Nov.", "Déc."];
        
        const faneroSigles = ["ARBMONDE", "FONS", "FEUSOL", "OPPO", "OEILESPI", "CREA", "FLUXAM"];
        const faneroSiglesShort = ["ARB", "FON", "FEU", "OPP", "OEI", "CRE", "FLU"];
        
        const zodiacCycles = [
            "BÉLIER", "TAUREAU", "GÉMEAUX", "CANCER", "LION", "VIERGE",
            "BALANCE", "SCORPION", "SAGITTAIRE", "CAPRICORNE", "VERSEAU", "POISSONS"
        ];

        // Conversion vers Calendrier Persan (Solaire Hijri)
        function getPersianDate(date) {
            let g_y = date.getFullYear();
            let g_m = date.getMonth() + 1;
            let g_d = date.getDate();
            let gy = g_y - 1600;
            let gm = g_m - 1;
            let gd = g_d - 1;
            let g_day_no = 365 * gy + Math.floor((gy + 3) / 4) - Math.floor((gy + 99) / 100) + Math.floor((gy + 399) / 400);
            for (let i = 0; i < gm; ++i) g_day_no += [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][i];
            if (gm > 1 && ((gy % 4 === 0 && gy % 100 !== 0) || (gy % 400 === 0))) g_day_no++;
            g_day_no += gd;
            let j_day_no = g_day_no - 79;
            let j_np = Math.floor(j_day_no / 12053);
            j_day_no %= 12053;
            let jy = 979 + 33 * j_np + 4 * Math.floor(j_day_no / 1461);
            j_day_no %= 1461;
            if (j_day_no >= 366) {
                jy += Math.floor((j_day_no - 1) / 365);
                j_day_no = (j_day_no - 1) % 365;
            }
            let jm, jd;
            const daysInMonths = [31, 31, 31, 31, 31, 31, 30, 30, 30, 30, 30, 29];
            for (let i = 0; i < 12; i++) {
                if (j_day_no < daysInMonths[i]) {
                    jm = i + 1;
                    jd = j_day_no + 1;
                    break;
                }
                j_day_no -= daysInMonths[i];
            }
            return { y: jy, m: jm, d: jd };
        }

        function setPlan(plan) {
            currentPlan = plan;
            const btnReal = document.getElementById('btn-real');
            const btnUniv = document.getElementById('btn-universe');
            const sigleMain = document.getElementById('sigle-main');

            if(plan === 'real') {
                btnReal.className = "py-4 rounded-full serif-title text-[0.7rem] tracking-widest transition-all btn-active-real";
                btnUniv.className = "py-4 rounded-full serif-title text-[0.7rem] tracking-widest transition-all opacity-40";
                sigleMain.style.color = "var(--gold-fanero)";
            } else {
                btnUniv.className = "py-4 rounded-full serif-title text-[0.7rem] tracking-widest transition-all btn-active-fareno";
                btnReal.className = "py-4 rounded-full serif-title text-[0.7rem] tracking-widest transition-all opacity-40";
                sigleMain.style.color = "var(--blue-fanero)";
            }
            updateTime();
        }

        function updateTime() {
            const now = new Date();
            const pDate = getPersianDate(now);
            const secTotalFanero = Math.floor((Date.now() - Date.UTC(2025, 5, 21, 0, 0, 0)) / 1000);

            // Mise à jour Header Global
            document.getElementById('day-num').innerText = now.getDate();
            document.getElementById('day-name-small').innerText = monthsReal[now.getMonth()];
            document.getElementById('day-name-real').innerText = fullDaysReal[now.getDay()];

            if(currentPlan === 'real') {
                const wdIdx = now.getDay();
                const switchDate = new Date(2026, 2, 21);
                let rayonReal = now >= switchDate ? 5326 : 5325;
                
                document.getElementById('sigle-main').innerText = shortDaysReal[wdIdx];
                document.getElementById('day-full').innerText = fullDaysReal[wdIdx];
                document.getElementById('val-rayon-sketch').innerText = rayonReal;
                
                // SYNCHRONISATION : Le numéro du cycle est le jour du mois persan (jd)
                // Le nom du cycle est le signe zodiacal correspondant au mois persan (jm)
                document.getElementById('cycle-name').innerText = zodiacCycles[pDate.m - 1];
                document.getElementById('cycle-num').innerText = pDate.d;
                document.getElementById('persian-sync-info').innerText = "Sync. Esfand " + pDate.y;
                
                const isWinter = (pDate.m >= 10 || pDate.m <= 1);
                document.getElementById('season-label').innerText = isWinter ? "Hiver" : "Printemps";
                
                document.getElementById('val-onde').innerText = String(now.getHours()).padStart(2, '0');
                document.getElementById('val-impulsion').innerText = String(now.getMinutes()).padStart(2, '0');
                document.getElementById('val-battement').innerText = String(now.getSeconds()).padStart(2, '0');
            } 
            else {
                // Plan Fareno (Calculs ésotériques)
                const n0 = secTotalFanero;
                const batt = (n0 % 9) + 1;
                const puls = (Math.floor(n0 / 9) % 9) + 1;
                const onde = (Math.floor(n0 / 81) % 36) + 1;
                const fluxInTrame = (Math.floor(n0 / 2916) % 7) + 1;
                const cycleIdx = (Math.floor(n0 / 81648) % 12);
                const rayonFanero = Math.floor(n0 / 979776) + 1;

                document.getElementById('sigle-main').innerText = faneroSiglesShort[fluxInTrame - 1];
                document.getElementById('day-full').innerText = faneroSigles[fluxInTrame - 1];
                document.getElementById('val-rayon-sketch').innerText = rayonFanero;
                document.getElementById('cycle-name').innerText = zodiacCycles[cycleIdx];
                document.getElementById('cycle-num').innerText = fluxInTrame;
                document.getElementById('persian-sync-info').innerText = "Fareno Flux";

                const seasons = ["Terture", "Foyture", "Airition", "Oflux"];
                document.getElementById('season-label').innerText = seasons[Math.floor(cycleIdx / 3)];

                document.getElementById('val-onde').innerText = String(onde).padStart(2, '0');
                document.getElementById('val-impulsion').innerText = String(puls).padStart(2, '0');
                document.getElementById('val-battement').innerText = String(batt).padStart(2, '0');
            }
        }

        setInterval(updateTime, 1000);
        updateTime();
    </script>
</body>
</html>
